if("function"!=typeof Blob&&"object"!=typeof Blob||"undefined"==typeof URL)if("function"!=typeof Blob&&"object"!=typeof Blob||"undefined"==typeof webkitURL)var Blob=function(e){"use strict";var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},o=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},r=n.prototype,i=o.prototype,a=e.FileReaderSync,c=function(e){this.code=this[this.name=e]},s="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),l=s.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,p=d.revokeObjectURL,f=d,w=e.btoa,h=e.atob,y=e.ArrayBuffer,g=e.Uint8Array;for(o.fake=i.fake=!0;l--;)c.prototype[s[l]]=l+1;return d.createObjectURL||(f=e.URL={}),f.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof o?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):w?t+";base64,"+w(e.data):t+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},f.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&p&&p.call(d,e)},r.append=function(e){var n=this.data;if(g&&(e instanceof y||e instanceof g)){for(var r="",i=new g(e),s=0,l=i.length;l>s;s++)r+=String.fromCharCode(i[s]);n.push(r)}else if("Blob"===t(e)||"File"===t(e)){if(!a)throw new c("NOT_READABLE_ERR");var d=new a;n.push(d.readAsBinaryString(e))}else e instanceof o?"base64"===e.encoding&&h?n.push(h(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},r.getBlob=function(e){return arguments.length||(e=null),new o(this.data.join(""),e,"raw")},r.toString=function(){return"[object BlobBuilder]"},i.slice=function(e,t,n){var r=arguments.length;return 3>r&&(n=null),new o(this.data.slice(e,r>1?t:this.data.length),n,this.encoding)},i.toString=function(){return"[object Blob]"},n}(e);return function(e,n){var o=n?n.type||"":"",r=new t;if(e)for(var i=0,a=e.length;a>i;i++)r.append(e[i]);return r.getBlob(o)}}(self);else self.URL=webkitURL;var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=e.URL||e.webkitURL||e,r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i=!e.externalHost&&"download"in r,a=e.webkitRequestFileSystem,c=e.requestFileSystem||a||e.mozRequestFileSystem,s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",d=0,u=[],p=function(){for(var e=u.length;e--;){var t=u[e];"string"==typeof t?o.revokeObjectURL(t):t.remove()}u.length=0},f=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(i){s(i)}}},w=function(o,s){var p,w,h,y=this,g=o.type,v=!1,m=function(){var e=n().createObjectURL(o);return u.push(e),e},b=function(){f(y,"writestart progress write writeend".split(" "))},$=function(){(v||!p)&&(p=m(o)),w?w.location.href=p:window.open(p,"_blank"),y.readyState=y.DONE,b()},_=function(e){return function(){return y.readyState!==y.DONE?e.apply(this,arguments):void 0}},R={create:!0,exclusive:!1};if(y.readyState=y.INIT,s||(s="download"),i){p=m(o),t=e.document,r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r.href=p,r.download=s;var k=t.createEvent("MouseEvents");return k.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(k),y.readyState=y.DONE,b(),void 0}return e.chrome&&g&&g!==l&&(h=o.slice||o.webkitSlice,o=h.call(o,0,o.size,l),v=!0),a&&"download"!==s&&(s+=".download"),(g===l||a)&&(w=e),c?(d+=o.size,c(e.TEMPORARY,d,_(function(e){e.root.getDirectory("saved",R,_(function(e){var t=function(){e.getFile(s,R,_(function(e){e.createWriter(_(function(t){t.onwriteend=function(t){w.location.href=e.toURL(),u.push(e),y.readyState=y.DONE,f(y,"writeend",t)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&$()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=y["on"+e]}),t.write(o),y.abort=function(){t.abort(),y.readyState=y.DONE},y.readyState=y.WRITING}),$)}),$)};e.getFile(s,{create:!1},_(function(e){e.remove(),t()}),_(function(e){e.code===e.NOT_FOUND_ERR?t():$()}))}),$)}),$),void 0):($(),void 0)},h=w.prototype,y=function(e,t){return new w(e,t)};return h.abort=function(){var e=this;e.readyState=e.DONE,f(e,"abort")},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,e.addEventListener("unload",p,!1),y}(this.self||this.window||this.content);"undefined"!=typeof module&&(module.exports=saveAs),$(function(){function e(){var e=new Date;return{getDiff:function(){var t=new Date;return t.getTime()-e}}}function t(e,t){for(var n="",o=0;o<e.length;o++)n+=e.charAt(o),(o+1)%t==0&&o>0&&(n+="\n");return n}function n(){if(null!=b){var e=b.getDiff();$("#coloring").html("syntax: "+e+"ms,");var t=m+e;$("#totaltime").html("total: "+t+"ms")}}function o(e,t,n){n||(n=102400);var o,r,i,a,c=e.length.toString(16).replace(/./g,"0"),s=20,l=[],d=0;for(l.push("Binary file of type: "+t+"\n"),l.push("\n");d<e.length;){if(n>=0&&d>=n){l.push("\n"),l.push("too much data, stopping now\n");break}for(o=e.slice(d,d+s),r=(c+d.toString(16)).slice(-c.length)+":",d+=o.length,i=0;s>i;)for(r+=" ",a=0;4>a;++a,++i)r+=i<o.length?("00"+o[i].toString(16)).slice(-2)+" ":"   ";r+="| ",r+=String.fromCharCode.apply(String,o).replace(/[\0-\x1F\x7F-\x9F\xAD]/g,"."),r+="\n",l.push(r)}return l.join("")}function r(){$("#decrypting").hide();var t=g.key||window.location.hash.substring(1),n=g.data,r=g.cipher;if(""==n)return $("#askpassword").show(),$("#typepassword").focus(),!1;if($("#askpassword").hide(),""==t)return $("#insertkey").show(),$("#typekey").focus(),!1;$("#insertkey").hide(),$("#decrypting").show();var i=new e;window.ezcrypt.async_decrypt([t,n,r],function(t,n){if(t){g.result=t,m=i.getDiff(),$("#execute").html("decryption: "+m+"ms,");var r;if($("#wrapholder").show(),$("#content_container").show(),$("#decrypting").hide(),b=new e,"string"==typeof t||t instanceof String){try{var r=new Blob([t],{type:c})}catch(a){y.log("saveAs not working:"),y.log(a)}v.setOption("mode",g.syntax),v.setValue(t),$("#showhex").hide()}else{try{var r=new Blob([new Uint8Array(t)],{type:c})}catch(a){y.log("saveAs not working:"),y.log(a)}var c=g.syntax,s=!1;try{if(r&&c.match(/^image\//)){var l=$("<img>");$("#alternate_content").append(l),s=!0;var d=new FileReader;d.onload=function(){l[0].src=d.result},d.readAsDataURL(r)}}catch(a){y.log("special binary handling failed:"),y.log(a)}v.setOption("mode","text/plain"),v.setValue(o(t,c)),$("#showhex").toggle(s),$("#content_container").toggle(!s)}r?$("#saveas").show().bind("click",function(){saveAs(r)}):$("#saveas").hide()}else n&&($("#decrypting").hide(),alert(n))})}function i(e){var t="",n=window.location.href,o=window.location.hash,i=n.indexOf(o)||n.length,a=n.substr(0,i);e||(t="p="+window.ezcrypt_backend.sha($("#typepassword").val())),$("#decrypting").show(),$.ajax({url:a,type:"POST",dataType:"json",data:t,cache:!1,success:function(e){g.data=e.data,g.syntax=e.syntax,g.cipher=e.cipher,r()},error:function(){e?r():alert("bad password!")}})}function a(e){R||!U?c(e):k?e&&_.push(e):e.apply(this,U)}function c(n){if(U=!1,null!=R&&(clearTimeout(R),R=null),k)return k=2,n&&_.push(n),void 0;var o=$("#new_key").val(),r=$("#new_text").val(),i=$("#new_cipher").val();if($("#new_result").html(""),$("#new_encrypttime").html(""),""==o||""==r)return"";var a=new e;window.ezcrypt.async_encrypt([o,r,i],function(e,n,o){if(!o){if(2==k)return k=0,c(),void 0;k=0}e&&(e=t(e,96),$("#new_encrypttime").html("encryption: "+a.getDiff()+"ms"),$("#new_result").val(e));var r,i,s=o?_.slice():_.splice(0);for(U=[e,n,o],r=0,i=s.length;i>r;++r)s[r].call(this,U)})}function s(){null!=R&&(clearTimeout(R),R=null),R=setTimeout(function(){R=null,c()},500)}function l(){var e=$("#new_key").val(),t=$("#new_cipher").val(),n=$("#new_ttl").val(),o=$("#upload_file")[0].files[0],r=o.type||"application/octet-stream",i="";$("#new_usepassword").is(":checked")&&(i=window.ezcrypt_backend.sha($("#new_typepassword").val()));var a=new FileReader;a.onload=function(){var o=new Uint8Array(a.result);window.ezcrypt.async_encrypt([e,o,t,{binary:!0}],function(o){o&&$.ajax({url:document.baseURI,type:"POST",dataType:"json",data:"data="+encodeURIComponent(o)+"&p="+i+"&ttl="+encodeURIComponent(n)+"&syn="+encodeURIComponent(r)+"&cipher="+encodeURIComponent(t),cache:!1,success:function(t){if(-100==n);else{var o="";""!=i&&(o="?p="+i),window.location=document.baseURI+"p/"+t.id+o+"#"+e}},error:function(){enableHover(),alert("error submitting form")}})})},a.readAsArrayBuffer(o)}function d(){if(""==$("#new_text").val())return!1;var e=$("#new_key").val(),t=$("#new_cipher").val(),n=$("#new_ttl").val(),o=$("#new_syntax").val(),r="";$("#new_usepassword").is(":checked")&&(r=window.ezcrypt_backend.sha($("#new_typepassword").val())),a(function(i){i&&$.ajax({url:document.baseURI,type:"POST",dataType:"json",data:"data="+encodeURIComponent(i)+"&p="+r+"&ttl="+encodeURIComponent(n)+"&syn="+encodeURIComponent(o)+"&cipher="+encodeURIComponent(t),cache:!1,success:function(t){if(-100==n);else{var o="";""!=r&&(o="?p="+r),window.location=document.baseURI+"p/"+t.id+o+"#"+e}},error:function(){enableHover(),alert("error submitting form")}})})}var u,p,f,w,h=!1,y="undefined"==typeof window.console?{}:window.console;"undefined"==typeof y.log&&(y.log=function(){});var g={data:"",cipher:"",syntax:"",key:!1};"undefined"!=typeof Worker&&"undefined"==typeof window.ezcrypt_worker?(u=new Worker(window.ezcrypt_crypto_backend_url),p={},f=0,u.onmessage=function(e){var t=e.data;if(t.id){var n=p[t.id];n&&(t.hasOwnProperty("progress")||delete p[t.id],n(t.result,t.error,t.progress))}},window.ezcrypt_backend.randomKey(function(e){u.postMessage({id:0,func:"_add_entropy",arguments:[e,128,"ezcrypt backend random"]})}),w=function(e,t,n){if(!h){var o;window.sjcl&&window.sjcl.random?(o=window.sjcl.random.randomWords(16,0),u.postMessage({id:0,func:"_add_entropy",arguments:[o,32,"sjcl.random"]})):(o=4294967296*Math.random()^0,u.postMessage({id:0,func:"_add_entropy",arguments:[o,1,"Math.random"]}))}var r=++f;p[r]=n,u.postMessage({id:r,func:e,arguments:t})}):w=function(e,t,n){try{n({result:window.ezcrypt[e].apply(this,t)})}catch(o){n({error:o})}};var v,m=0,b=null,_=[],R=null,k=0,U=!1;window.ezcrypt={sha:window.ezcrypt_backend.sha,encrypt:window.ezcrypt_backend.encrypt,decrypt:window.ezcrypt_backend.decrypt,async_encrypt:w.bind(this,"encrypt"),async_decrypt:w.bind(this,"decrypt")},document.getElementById("content")&&(window.ezcrypt.editor=v=CodeMirror.fromTextArea(document.getElementById("content"),{lineNumbers:!0,matchBrackets:!1,lineWrapping:!1,readOnly:!0,onChange:n})),$("#new_key").length&&($("#upload").hide(),$("#upload").bind("click",function(e){return $("#upload_file").click(),e.preventDefault(),!1}),window.ezcrypt_backend.randomKey(function(e){$("#new_key").val(e);var t=$("#en");t.bind("click",d),$("#upload_file").bind("change",l),t.removeAttr("disabled"),t.val("Submit"),"undefined"!=typeof FileReader&&$("#upload").show();var n=$("#new_text");""!=n.val()&&s(),n.bind("textchange",s),n.live("keydown",function(e){13==e.keyCode&&e.ctrlKey&&t.click()}),t.hover(function(){$("#new_result").show(),$("#new_encrypttime").show()},function(){$("#new_result").hide(),$("#new_encrypttime").hide()})})),$("#new_usepassword").change(function(){this.checked?$("#new_typepassword").show():$("#new_typepassword").hide()}),$("#askpassword").length&&($("#content_container").hide(),$("#submitpassword").bind("click",function(){i(!1)}),$("#submitkey").bind("click",function(){g.key=$("#typekey").val(),r()}),$("#typepassword,#typekey").live("keydown",function(e){13==e.keyCode&&$(this).parent().find("input[type=button]").click()}),$("#new").bind("click",function(){$("#new_text").html(""),$("#new_result").val(""),$("#newpaste").slideDown()}),$("#clone").bind("click",function(){$("#new_text").html(v.getValue()).trigger("textchange"),$("#newpaste").slideDown()}),$("#tool-wrap").bind("click",function(){var e=$("#tool-wrap").is(":checked");$(".tool-wrap").toggleClass("tool-wrap-on",e),v.setOption("lineWrapping",e)}),$("#tool-numbers").bind("click",function(){var e=$("#tool-numbers").is(":checked");$(".tool-numbers").toggleClass("tool-numbers-on",e),v.setOption("lineNumbers",e)}),$("#tool-fullscreen").bind("click",function(){var e=$("#tool-fullscreen").is(":checked");$(".tool-fullscreen").toggleClass("tool-fullscreen-on",e),$("#holder").css("width",e?"100%":"")}),$("#showhex").bind("click",function(){$("#content_container").toggle()}),window.ezcrypt_paste?(g=window.ezcrypt_paste,r()):i(!0))});
//# sourceMappingURL=main-97a4884a0c68e4433e10af0bb7a191850ac1361b.min.map