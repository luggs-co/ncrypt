var global="undefined"!=typeof window&&null!==window?window:this;!function(){function t(t,e){var i=e&&e.binary;return i?u.codec.bytes.toBits(t):u.codec.utf8String.toBits(t)}function e(t,e){var i=e&&e.binary;if(!i)try{return u.codec.utf8String.fromBits(t)}catch(r){l.log("Couldn't decode to UTF-8, trying binary instead:"),l.log(r)}return u.codec.bytes.fromBits(t)}function i(t,e){return u.misc.pbkdf2(t,e,1,256,function(t){return new u.misc.hmac(t,u.hash.sha1)})}function r(t,e,i){if(128!==f.bitLength(i))throw new u.exception.invalid("ofb iv must be 128 bits");var r,n=f.bitLength(e),o=0,s=e;for(r=0;n>=o;r+=4,o+=128)i=t.encrypt(i),s[r]^=i[0],s[r+1]^=i[1],s[r+2]^=i[2],s[r+3]^=i[3];return s.splice(n+31>>5),n%=32,n>0&&(s[s.length-1]=f.partial(n,s[s.length-1]&2147483648>>n-1,1)),s}function n(t,e){var n=e.splice(0,4),o=new u.cipher.aes(i(t,n));return r(o,e,n)}function o(t,e){var n=u.random.randomWords(4,0),o=new u.cipher.aes(i(t,n)),s=r(o,e,n);return s.splice(0,0,n[0],n[1],n[2],n[3]),s}function s(t,e){var i=f.concat(u.codec.utf8String.toBits(t),e),r=u.hash.md5.hash,n=r(i),o=r(n.concat(i));return[n,o]}function a(t,e){var i=e.splice(0,2);if("Salted__"!==u.codec.utf8String.fromBits(i))throw"AES-128-CBC: unexpected input, missing 'Salted__' prefix";var r=e.splice(0,2),n=s(t,r),o=new u.cipher.aes(n[0]);return u.mode.cbc.decrypt(o,e,n[1],[])}function h(t,e){var i=u.codec.utf8String.toBits("Salted__"),r=u.random.randomWords(2,0),n=s(t,r),o=new u.cipher.aes(n[0]),a=u.mode.cbc.encrypt(o,e,n[1],[]);return i.concat(r,a)}var c=global,l="undefined"==typeof global.console?{}:global.console;"undefined"==typeof l.log&&(l.log=function(){});var u={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=u),u.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,i,r,n,o,s=this._tables[0][4],a=this._tables[1],h=t.length,c=1;if(4!==h&&6!==h&&8!==h)throw new u.exception.invalid("invalid aes key size");for(this._key=[n=t.slice(0),o=[]],e=h;4*h+28>e;e++)r=n[e-1],(e%h===0||8===h&&e%h===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],e%h===0&&(r=r<<8^r>>>24^c<<24,c=c<<1^283*(c>>7))),n[e]=n[e-h]^r;for(i=0;e;i++,e--)r=n[3&i?e:e-4],o[i]=4>=e||4>i?r:a[0][s[r>>>24]]^a[1][s[r>>16&255]]^a[2][s[r>>8&255]]^a[3][s[255&r]]},u.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,i,r,n,o,s,a,h,c=this._tables[0],l=this._tables[1],u=c[4],f=l[4],d=[],_=[];for(t=0;256>t;t++)_[(d[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!u[e];e^=r||1,i=_[i]||1)for(s=i^i<<1^i<<2^i<<3^i<<4,s=s>>8^255&s^99,u[e]=s,f[s]=e,o=d[n=d[r=d[e]]],h=16843009*o^65537*n^257*r^16843008*e,a=257*d[s]^16843008*s,t=0;4>t;t++)c[t][e]=a=a<<24^a>>>8,l[t][s]=h=h<<24^h>>>8;for(t=0;5>t;t++)c[t]=c[t].slice(0),l[t]=l[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new u.exception.invalid("invalid aes block size");var i,r,n,o,s=this._key[e],a=t[0]^s[0],h=t[e?3:1]^s[1],c=t[2]^s[2],l=t[e?1:3]^s[3],f=s.length/4-2,d=4,_=[0,0,0,0],p=this._tables[e],b=p[0],g=p[1],y=p[2],m=p[3],v=p[4];for(o=0;f>o;o++)i=b[a>>>24]^g[h>>16&255]^y[c>>8&255]^m[255&l]^s[d],r=b[h>>>24]^g[c>>16&255]^y[l>>8&255]^m[255&a]^s[d+1],n=b[c>>>24]^g[l>>16&255]^y[a>>8&255]^m[255&h]^s[d+2],l=b[l>>>24]^g[a>>16&255]^y[h>>8&255]^m[255&c]^s[d+3],d+=4,a=i,h=r,c=n;for(o=0;4>o;o++)_[e?3&-o:o]=v[a>>>24]<<24^v[h>>16&255]<<16^v[c>>8&255]<<8^v[255&l]^s[d++],i=a,a=h,h=c,c=l,l=i;return _}},void 0===u.beware&&(u.beware={}),u.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){u.mode.cbc={name:"cbc",encrypt:function(t,e,i,r){if(r&&r.length)throw new u.exception.invalid("cbc can't authenticate data");if(128!==u.bitArray.bitLength(i))throw new u.exception.invalid("cbc iv must be 128 bits");var n,o=u.bitArray,s=o._xor4,a=o.bitLength(e),h=0,c=[];if(7&a)throw new u.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(n=0;a>=h+128;n+=4,h+=128)i=t.encrypt(s(i,e.slice(n,n+4))),c.splice(n,0,i[0],i[1],i[2],i[3]);return a=16843009*(16-(a>>3&15)),i=t.encrypt(s(i,o.concat(e,[a,a,a,a]).slice(n,n+4))),c.splice(n,0,i[0],i[1],i[2],i[3]),c},decrypt:function(t,e,i,r){if(r&&r.length)throw new u.exception.invalid("cbc can't authenticate data");if(128!==u.bitArray.bitLength(i))throw new u.exception.invalid("cbc iv must be 128 bits");if(127&u.bitArray.bitLength(e)||!e.length)throw new u.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var n,o,s,a=u.bitArray,h=a._xor4,c=[];for(r=r||[],n=0;n<e.length;n+=4)o=e.slice(n,n+4),s=h(i,t.decrypt(o)),c.splice(n,0,s[0],s[1],s[2],s[3]),i=o;if(o=255&c[n-1],0===o||o>16)throw new u.exception.corrupt("pkcs#5 padding corrupt");if(s=16843009*o,!a.equal(a.bitSlice([s,s,s,s],0,8*o),a.bitSlice(c,32*c.length-8*o,32*c.length)))throw new u.exception.corrupt("pkcs#5 padding corrupt");return a.bitSlice(c,0,32*c.length-8*o)}}},u.bitArray={bitSlice:function(t,e,i){return t=u.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===i?t:u.bitArray.clamp(t,i-e)},extract:function(t,e,i){var r,n=Math.floor(-e-i&31);return r=-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n,r&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],r=u.bitArray.getPartial(i);return 32===r?t.concat(e):u.bitArray._shiftRight(e,r,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e,i=t.length;return 0===i?0:(e=t[i-1],32*(i-1)+u.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var i=t.length;return e=31&e,i>0&&e&&(t[i-1]=u.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(u.bitArray.bitLength(t)!==u.bitArray.bitLength(e))return!1;var i,r=0;for(i=0;i<t.length;i++)r|=t[i]^e[i];return 0===r},_shiftRight:function(t,e,i,r){var n,o,s=0;for(void 0===r&&(r=[]);e>=32;e-=32)r.push(i),i=0;if(0===e)return r.concat(t);for(n=0;n<t.length;n++)r.push(i|t[n]>>>e),i=t[n]<<32-e;return s=t.length?t[t.length-1]:0,o=u.bitArray.getPartial(s),r.push(u.bitArray.partial(e+o&31,e+o>32?i:r.pop(),1)),r},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},u.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var r,n="",o=0,s=u.codec.base64._chars,a=0,h=u.bitArray.bitLength(t);for(i&&(s=s.substr(0,62)+"-_"),r=0;6*n.length<h;)n+=s.charAt((a^t[r]>>>o)>>>26),6>o?(a=t[r]<<6-o,o+=26,r++):(a<<=6,o-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,r,n=[],o=0,s=u.codec.base64._chars,a=0;for(e&&(s=s.substr(0,62)+"-_"),i=0;i<t.length;i++){if(r=s.indexOf(t.charAt(i)),0>r)throw new u.exception.invalid("this isn't base64!");o>26?(o-=26,n.push(a^r>>>o),a=r<<32-o):(o+=6,a^=r<<32-o)}return 56&o&&n.push(u.bitArray.partial(56&o,a,1)),n}},u.codec.base64url={fromBits:function(t){return u.codec.base64.fromBits(t,1,1)},toBits:function(t){return u.codec.base64.toBits(t,1)}},u.codec.bytes={fromBits:function(t){var e,i,r=[],n=u.bitArray.bitLength(t);for(e=0;n/8>e;e++)0===(3&e)&&(i=t[e/4]),r.push(i>>>24),i<<=8;return r},toBits:function(t){var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t[e],3===(3&e)&&(i.push(r),r=0);return 3&e&&i.push(u.bitArray.partial(8*(3&e),r)),i}},u.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=((0|t[e])+0xf00000000000).toString(16).substr(4);return i.substr(0,u.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,r=[];for(t=t.replace(/\s|0x/g,""),i=t.length,t+="00000000",e=0;e<t.length;e+=8)r.push(0^parseInt(t.substr(e,8),16));return u.bitArray.clamp(r,4*i)}},u.codec.utf8String={fromBits:function(t){var e,i,r="",n=u.bitArray.bitLength(t);for(e=0;n/8>e;e++)0===(3&e)&&(i=t[e/4]),r+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(r))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t.charCodeAt(e),3===(3&e)&&(i.push(r),r=0);return 3&e&&i.push(u.bitArray.partial(8*(3&e),r)),i}},u.misc.hmac=function(t,e){this._hash=e=e||u.hash.sha256;var i,r=[[],[]],n=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>n&&(t=e.hash(t)),i=0;n>i;i++)r[0][i]=909522486^t[i],r[1][i]=1549556828^t[i];this._baseHash[0].update(r[0]),this._baseHash[1].update(r[1]),this._resultHash=new e(this._baseHash[0])},u.misc.hmac.prototype.encrypt=u.misc.hmac.prototype.mac=function(t){if(this._updated)throw new u.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},u.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},u.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},u.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e},u.misc.pbkdf2=function(t,e,i,r,n){if(i=i||1e3,0>r||0>i)throw u.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=u.codec.utf8String.toBits(t)),"string"==typeof e&&(e=u.codec.utf8String.toBits(e)),n=n||u.misc.hmac;var o,s,a,h,c,l=new n(t),f=[],d=u.bitArray;for(c=1;32*f.length<(r||1);c++){for(o=s=l.encrypt(d.concat(e,[c])),a=1;i>a;a++)for(s=l.encrypt(s),h=0;h<s.length;h++)o[h]^=s[h];f=f.concat(o)}return r&&(f=d.clamp(f,r)),f},u.hash.md5=function(t){this._T[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},u.hash.md5.hash=function(t){return(new u.hash.md5).update(t).finalize()},u.hash.md5.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=u.codec.utf8String.toBits(t));var e,i=this._buffer=u.bitArray.concat(this._buffer,t),r=this._length,n=this._length=r+u.bitArray.bitLength(t);for(e=this.blockSize+r&-this.blockSize;n>=e;e+=this.blockSize)this._block(i.splice(0,16),!0);return this},finalize:function(){var t,e=this._buffer,i=this._h;for(e=u.bitArray.concat(e,[u.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(0|this._length),e.push(this._length/4294967296|0);e.length;)this._block(e.splice(0,16),e.length);return this.reset(),this._BS(i,4),i},_init:[1732584193,4023233417,2562383102,271733878],_BS:function(t,e){var i,r;for(i=0;e>i;i++)r=t[i],t[i]=r>>>24|r>>8&65280|(65280&r)<<8|(255&r)<<24},_T:[],_precompute:function(){var t;for(t=0;64>t;t++)this._T[t]=4294967296*Math.abs(Math.sin(t+1))|0},_block:function(t,e){var i,r,n,o,s,a=t.slice(0),h=this._h,c=this._T;for(r=h[0],n=h[1],o=h[2],s=h[3],this._BS(a,e?16:14),i=0;64>i;i++){var l,u,f,d;32>i?16>i?(l=n&o|~n&s,u=i,f=[7,12,17,22]):(l=s&n|~s&o,u=(5*i+1)%16,f=[5,9,14,20]):48>i?(l=n^o^s,u=(3*i+5)%16,f=[4,11,16,23]):(l=o^(n|~s),u=7*i%16,f=[6,10,15,21]),d=r+l+a[u]+c[i],r=s,s=o,o=n,n=(d<<f[i%4]|d>>>32-f[i%4])+n|0}h[0]+=r,h[1]+=n,h[2]+=o,h[3]+=s}},u.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},u.hash.sha1.hash=function(t){return(new u.hash.sha1).update(t).finalize()},u.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=u.codec.utf8String.toBits(t));var e,i=this._buffer=u.bitArray.concat(this._buffer,t),r=this._length,n=this._length=r+u.bitArray.bitLength(t);for(e=this.blockSize+r&-this.blockSize;n>=e;e+=this.blockSize)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(e=u.bitArray.concat(e,[u.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,i,r){return 19>=t?e&i|~e&r:39>=t?e^i^r:59>=t?e&i|e&r|i&r:79>=t?e^i^r:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){{var e,i,r,n,o,s,a,h=t.slice(0),c=this._h;this._key}for(r=c[0],n=c[1],o=c[2],s=c[3],a=c[4],e=0;79>=e;e++)e>=16&&(h[e]=this._S(1,h[e-3]^h[e-8]^h[e-14]^h[e-16])),i=this._S(5,r)+this._f(e,n,o,s)+a+h[e]+this._key[Math.floor(e/20)]|0,a=s,s=o,o=this._S(30,n),n=r,r=i;c[0]=c[0]+r|0,c[1]=c[1]+n|0,c[2]=c[2]+o|0,c[3]=c[3]+s|0,c[4]=c[4]+a|0}},u.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},u.hash.sha256.hash=function(t){return(new u.hash.sha256).update(t).finalize()},u.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=u.codec.utf8String.toBits(t));var e,i=this._buffer=u.bitArray.concat(this._buffer,t),r=this._length,n=this._length=r+u.bitArray.bitLength(t);for(e=512+r&-512;n>=e;e+=512)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(e=u.bitArray.concat(e,[u.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,i=0,r=2;t:for(;64>i;r++){for(e=2;r>=e*e;e++)if(r%e===0)continue t;8>i&&(this._init[i]=t(Math.pow(r,.5))),this._key[i]=t(Math.pow(r,1/3)),i++}},_block:function(t){var e,i,r,n,o=t.slice(0),s=this._h,a=this._key,h=s[0],c=s[1],l=s[2],u=s[3],f=s[4],d=s[5],_=s[6],p=s[7];for(e=0;64>e;e++)16>e?i=o[e]:(r=o[e+1&15],n=o[e+14&15],i=o[15&e]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+o[15&e]+o[e+9&15]|0),i=i+p+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(_^f&(d^_))+a[e],p=_,_=d,d=f,f=u+i|0,u=l,l=c,c=h,h=i+(c&l^u&(c^l))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;s[0]=s[0]+h|0,s[1]=s[1]+c|0,s[2]=s[2]+l|0,s[3]=s[3]+u|0,s[4]=s[4]+f|0,s[5]=s[5]+d|0,s[6]=s[6]+_|0,s[7]=s[7]+p|0}},u.prng=function(t){this._pools=[new u.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},u.prng.prototype={randomWords:function(t,e){var i,r,n=[],o=this.isReady(e);if(o===this._NOT_READY)throw new u.exception.notReady("generator isn't seeded");for(o&this._REQUIRES_RESEED&&this._reseedFromPools(!(o&this._READY)),i=0;t>i;i+=4)(i+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),r=this._gen4words(),n.push(r[0],r[1],r[2],r[3]);return this._gate(),n.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,i){i=i||"user";var r,n,o,s,a=(new Date).valueOf(),h=this._robins[i],c=this.isReady(),l=0;switch(r=this._collectorIds[i],void 0===r&&(r=this._collectorIds[i]=this._collectorIdNext++),void 0===h&&(h=this._robins[i]=0),this._robins[i]=(this._robins[i]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[h].update([r,this._eventId++,1,e,a,1,0|t]);break;case"object":if(s=Object.prototype.toString.call(t),"[object Uint32Array]"===s){for(o=[],n=0;n<t.length;n++)o.push(t[n]);t=o}else for("[object Array]"!==s&&(l=1),n=0;n<t.length&&!l;n++)"number"!=typeof t[n]&&(l=1);if(!l){if(void 0===e)for(e=0,n=0;n<t.length;n++)for(o=t[n];o>0;)e++,o>>>=1;this._pools[h].update([r,this._eventId++,2,e,a,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[h].update([r,this._eventId++,3,e,a,t.length]),this._pools[h].update(t);break;default:l=1}if(l)throw new u.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[h]+=e,this._poolStrength+=e,c===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector)},c.addEventListener)c.addEventListener("load",this._eventListener.loadTimeCollector,!1),c.addEventListener("mousemove",this._eventListener.mouseCollector,!1),c.addEventListener("keypress",this._eventListener.keyboardCollector,!1),c.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1);else{if(!document.attachEvent)throw new u.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(c.removeEventListener?(c.removeEventListener("load",this._eventListener.loadTimeCollector,!1),c.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),c.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),c.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var i,r,n=this._callbacks[t],o=[];for(r in n)n.hasOwnProperty(r)&&n[r]===e&&o.push(r);for(i=0;i<o.length;i++)r=o[i],delete n[r]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new u.cipher.aes(this._key)},_reseed:function(t){this._key=u.hash.sha256.hash(this._key.concat(t)),this._cipher=new u.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,i=[],r=0;for(this._nextReseed=i[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(i=i.concat(this._pools[e].finalize()),r+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new u.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(i)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0;u.random.addEntropy([e,i],2,"mouse"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){c&&c.performance&&"function"==typeof c.performance.now?u.random.addEntropy(c.performance.now(),t,"loadtime"):u.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,i="";c.orientation&&(i=c.orientation),u.random.addEntropy([e,i],3,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var i,r=u.random._callbacks[t],n=[];for(i in r)r.hasOwnProperty(i)&&n.push(r[i]);for(i=0;i<n.length;i++)n[i](e)}},u.random=new u.prng(6),function(){try{var t,e,i;if("undefined"!=typeof module&&module.exports)e=require("crypto"),t=e.randomBytes(128),u.random.addEntropy(t,1024,"crypto.randomBytes");else if(c&&Uint32Array){if(i=new Uint32Array(32),c.crypto&&c.crypto.getRandomValues)c.crypto.getRandomValues(i);else{if(!c.msCrypto||!c.msCrypto.getRandomValues)return;c.msCrypto.getRandomValues(i)}u.random.addEntropy(i,1024,"crypto.getRandomValues")}}catch(r){l.log("There was an error collecting entropy from the browser:"),l.log(r)}}(),u.beware["CBC mode is dangerous because it doesn't protect message integrity."](),"undefined"==typeof global.sjcl&&(global.sjcl=u);var f=u.bitArray,d={decrypt:function(t,i,r,o){switch(i=u.codec.base64.toBits(i),r){case"AES-256-OFB":return e(n(t,i),o);case"AES-128-CBC":return e(a(t,i),o).slice(0,-1);default:throw'cipher "'+r+'" not supported'}},encrypt:function(e,i,r,n){switch(r){case"AES-256-OFB":i=o(e,t(i,n));break;case"AES-128-CBC":var s=u.codec.bytes.toBits([10]);i=h(e,f.concat(t(i,n),s));break;default:throw'cipher "'+r+'" not supported'}return u.codec.base64.fromBits(i)},sha:function(t){return u.codec.hex.fromBits(u.hash.sha1.hash(t))},randomKey:function(t){var e=!1;if(!u.random.isReady())return u.random._collectorsStarted||(u.random.startCollectors(),e=!0),setTimeout(function(){d.randomKey(t),e&&u.random.stopCollectors()},200),void 0;var i=u.codec.base64url.fromBits(u.random.randomWords(8));t(i)},_add_entropy:function(t,e,i){u.random.addEntropy(t,e,i)}};"undefined"==typeof global.crypto_backends&&(global.crypto_backends={}),global.crypto_backends.sjcl=d,"undefined"==typeof global.ezcrypt_backend&&(global.ezcrypt_backend=d)}(),"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(self.onmessage=function(t){var e=t.data;try{self.postMessage({id:e.id,func:e.func,result:global.ezcrypt_backend[e.func].apply(this,e.arguments)})}catch(i){console.log("exception in crypto worker:"),console.log(i),self.postMessage({id:e.id,func:e.func,error:i.toString()})}});
//# sourceMappingURL=sjcl-e6a466c07c2f131cb1901614082b60706a5e7a5b.min.map